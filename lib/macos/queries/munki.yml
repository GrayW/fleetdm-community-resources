- name: Munki Info
  description: Gets information from Munki on macOS endpoints
  query: |
    SELECT 
      *, 
      (SELECT username FROM users WHERE directory LIKE '/Users/%' ORDER BY uid LIMIT 1) AS primary_user 
    FROM 
      munki_info;
  platform: darwin
  interval: 3600 # runs hourly
  observer_can_run: true
  automations_enabled: true

- name: Munki Install
  description: Gets information from Munki on macOS endpoints
  query: |
    SELECT 
      name, 
      installed_version, 
      end_time, 
      (SELECT username FROM users WHERE directory LIKE '/Users/%' ORDER BY uid LIMIT 1) AS primary_user 
    FROM 
      munki_installs 
    WHERE 
      installed = 'true';
  platform: darwin
  interval: 7200 # runs every two hours
  observer_can_run: true
  automations_enabled: true